dat <- read.csv("~/Documents/CU AMC Fall 2017/BIOS6623/Project0_dental_data.csv")
head(dat)
summary(dat)
plot(dat$age)
dat$trtgroup <- factor(dat$trtgroup, levels = c(1, 2, 3, 4, 5),
table(dat$trtgroup)
table(dat$trtgroup)
dat$trtgroup <- factor(dat$trtgroup, levels = c(1, 2, 3, 4, 5),
labels = c("placebo", "control", "low", "med", "high"))
summary(dat$trtgroup)
dat$sex <- factor(dat$sex, levels = c(1, 2), labels = c("male", "female"))
dat$race <- factor(dat$race, levels = c(1, 2, 4, 5),
labels = c("native american", "african american", "asian", "white"))
dat$smoker <- factor(dat$smoker, levels = c(0, 1), labels = c("no", "yes"))
dat$atdiff <- dat$attach1year - dat$attachbase
dat$pddiff <- dat$pd1year - dat$pdbase
dropout.rows <- which(is.na(dat$pd1year)) # gives the row numbers for the people that dropped out at 1year
dat.dropout <- dat[dropout.rows, ]
table(dat.dropout$trtgroup)
plot(dat.dropout)
plot(dat.dropout$trtgroup)
plot(dat.dropout$trtgroup, xlab = "treatment group", ylab = "# subjects missing at 1 year",
main = "Trend in Participant Dropout Across Groups")
aggregate(pddiff ~ trtgroup, dat)
aggregate(pddiff ~ trtgroup, dat, mean)
aggregate(pddiff ~ trtgroup, dat, sd)
aggregate(atdiff ~ trtgroup, dat, mean)
aggregate(atdiff ~ trtgroup, dat, sd)
plot(dat$age ~ dat$trtgroup)
plot(dat$age ~ dat$trtgroup, xlab = "treatment group", ylab = "age",
main = "Age Across Treatment Group")
plot(dat$sites ~ dat$trtgroup, xlab = "treatment group", ylab = "# sites measured",
main = "Sites Across Treatment Group")
plot(dat$pddiff ~ dat$trtgroup, xlab = "treatment group", ylab = "Change in pocket depth",
main = "Change in Pocket Depth Across Treatment Group")
plot(dat$atdiff ~ dat$trtgroup, xlab = "treatment group", ylab = "Change in attachment",
main = "Change in Attachment Across Treatment Group")
plot(dat$pddiff ~ dat$sites)
plot(dat$pddiff ~ dat$sites, xlab = "sites", ylab = "pocket depth")
plot(dat$pddiff ~ dat$age, xlab = "age", ylab = "pocket depth")
plot(dat$pddiff ~ dat$race, xlab = "race", ylab = "pocket depth")
plot(dat$pddiff ~ dat$sex, xlab = "sex", ylab = "pocket depth")
plot(dat$pddiff ~ dat$smoker, xlab = "smoker?", ylab = "pocket depth")
plot(dat$atdiff ~ dat$sites, xlab = "sites", ylab = "change in attachment")
plot(dat$atdiff ~ dat$age, xlab = "age", ylab = "change in attachment")
plot(dat$atdiff ~ dat$race, xlab = "race", ylab = "change in attachment")
plot(dat$atdiff ~ dat$sex, xlab = "sex", ylab = "change in attachment")
plot(dat$atdiff ~ dat$smoker, xlab = "smoker?", ylab = "change in attachment")
lmpd1 <- lm(pddiff ~ trtgroup, data = dat)
summary(lmpd1)
lmpd1
AIC(lmpd1)
plot(residuals(lmpd1)~fitted(lmpd1), pch = 20, main = lmpd1)
plot((residuals(lmpd1))~(fitted(lmpd1)), pch = 20, main = lmpd1)
plot(lmpd1$residuals ~ lmpd1$fitted.values, pch = 20, main = lmpd1)
plot(lmpd1$residuals ~ lmpd1$fitted.values, pch = 20, main = "lmpd1")
qqnorm(scale(lmpd1$residuals), pch = 20, main = lmpd1)
qqnorm(scale(lmpd1$residuals), pch = 20, main = "lmpd1")
abline(0, 1, col = "red")
abline(0, 1, col = "red")
lmpd2 <- lm(pddiff ~ trtgroup + pdbase + sites + age + race + sex + smoker, data = dat)
plot(lmpd2$residuals ~ lmpd2$fitted.values, pch = 20, main = lmpd2)
qqnorm(scale(lmpd2$residuals), pch = 20, main = "lmpd2")
abline(0, 1, col = "red")
AIC(lmpd2)
lmpd3 <- lm(pddiff ~ trtgroup + sites + age + race + sex + smoker, data = dat)
AIC(lmpd3)
qqnorm(scale(lmpd3$residuals), pch = 20, main = "lmpd3")
abline(0, 1, col = "red")
plot(lmpd3$residuals ~ lmpd3$fitted.values, pch = 20, main = "lmpd3")
lmpd4 <- lm(pddiff ~ trtgroup + pdbase + age + race + sex + smoker, data = dat)
AIC(lmpd4)
plot(lmpd4$residuals~lmpd4$fitted.values, pch = 20, main = "lmpd")
plot(lmpd4$residuals~lmpd4$fitted.values, pch = 20, main = "lmpd4")
qqnorm(scale(residuals(lmpd4)), pch = 20, main = "lmpd4")
abline(0, 1, col = "red")
lmpd5 <- lm(pddiff ~ trtgroup + pdbase + sites + race + sex + smoker, data = dat)
AIC(lmpd5)
plot(lmpd5$residuals ~ lmpd5$fitted.values, pch = 20, main = "lmpd5")
qqnorm(scale(lmpd5$residuals), pch = 20, main = "lmpd5")
abline(0, 1, col = "red")
lmpd6 <- lm(pddiff ~ trtgroup + pdbase + sites + age + sex + smoker, data = dat)
AIC(lmpd6)
qqnorm(scale(lmpd6$residuals), pch = 20, main = "lmpd6")
abline(0, 1, col = "red")
plot(lmpd6$residuals ~ lmpd6$fitted.values, pch = 20, main = "lmpd6")
lmpd7 <- lm(pddiff ~ trtgroup + pdbase + sites + age + race + smoker, data = dat)
AIC(lmpd7)
plot(lmpd7$residuals ~ lmpd7$fitted.values, pch = 20, main = "lmpd7")
qqnorm(scale(lmpd7$residuals), pch = 20, main = "lmpd7")
abline(0, 1, col = "red")
lmpd8 <- lm(pddiff ~ trtgroup + pdbase + sites + age + race + sex, data = dat)
AIC(lmpd8)
lmpd9 <- lm(pddiff ~ trtgroup + pdbase, data = dat)
AIC(lmpd9)
plot(lmpd9$residuals ~ lmpd9$fitted.values, pch = 20, main = "lmpd9")
qqnorm(scale(lmpd9$residuals), pch = 20, main = "lmpd9")
abline(0, 1, col = "red")
lmpd10 <- lm(pddiff ~ trtgroup + sites, data = dat)
AIC(lmpd10)
plot(lmpd10$residuals ~ lmpd10$fitted.values, pch = 20, main = "lmpd10")
qqnorm(scale(lmpd10$residuals), pch = 20, main = "lmpd10")
abline(0, 1, col = "red")
lmpd11 <- lm(pddiff ~ trtgroup + age, data = dat)
AIC(lmpd11)
plot(lmpd11$residuals ~ lmpd11$fitted.values, pch = 20, main = "lmpd11")
qqnorm(scale(lmpd11$residuals), pch = 20, main = "lmpd11")
abline(0, 1, col = "red")
lmpd12 <- lm(pddiff ~ trtgroup + race, data = dat)
AIC(lmpd12)
plot(lmpd12$residuals ~ lmpd12$fitted.values, pch = 20, main = "lmpd12")
qqnorm(scale(lmpd12$residuals), pch = 20, main = "lmpd12")
abline(0, 1, col = "red")
lmpd13 <- lm(pddiff ~ trtgroup + sex, data = dat)
AIC(lmpd13)
plot(lmpd13$residuals ~ lmpd13$fitted.values, pch = 20, main = "lmpd13")
qqnorm(scale(lmpd13$residuals), pch = 20, main = "lmpd13")
abline(0, 1, col = "red")
lmpd14 <- lm(pddiff ~ trtgroup + smoker, data = dat)
AIC(lmpd14)
lmpd15 <- lm(pddiff ~ trtgroup + baselinepd + sex)
lmpd15 <- lm(pddiff ~ trtgroup + baselinepd + sex, data = dat)
lmpd15 <- lm(pddiff ~ trtgroup + pdbase + sex, data = dat)
AIC(lmpd15)
plot(lmpd15$residuals ~ lmpd15$fitted.values, pch = 20, main = "lmpd15")
qqnorm(scale(lmpd15$residuals), pch = 20, main = "lmpd15")
abline(0, 1, col = "red")
plot(dat$pdbase ~ dat$sex)
summary(lmpd15)
plot(dat$pdbase ~ dat$pd1year)
plot(dat$pd1year ~ dat$pdabse)
plot(dat$pd1year ~ dat$pdbase)
rm(list = c(lmpd2, lmpd3, lmpd4, lmpd5, lmpd6, lmpd7, lmpd8,lmpd10, lmpd11, lmpd12, lmpd14))
rm(lmpd2, lmpd3, lmpd4, lmpd5, lmpd6, lmpd7, lmpd8,lmpd10, lmpd11, lmpd12, lmpd14)
rm(lmpd1)
lmat1 <- lm(atdiff ~ trtgroup, data = dat)
AIC(lmat1)
plot(lmat1$residuals ~ lmat1$fitted.values, pch = 20, main = "lmat1")
qqnorm(scale(lmat1$residuals), pch = 20, main = "lmat1")
abline(0, 1, col = "red")
lmat2 <- lm(atdiff ~ trtgroup + attachbase + sites + age + race + sex + smoker, data = dat)
AIC(lmat2)
plot(lmat2$residuals ~ lmat2$fitted.values, pch = 20, main = "lmat2")
qqnorm(scale(lmat2$residuals), pch = 20, main = "lmat2")
abline(0, 1, col = "red")
lmat3 <- lm(atdiff ~ trtgroup + sites + age + race + sex + smoker, data = dat)
AIC(lmat3)
plot(lmat3$residuals ~ lmat3$fitted.values, pch = 20, main = "lmat3")
qqnorm(scale(lmat3$residuals), pch = 20, main = "lmat3")
abline(0, 1, col = "red")
lmat4 <- lm(atdiff ~ trtgroup + attachbase + age + race + sex + smoker, data = dat)
AIC(lmat4)
qqnorm(scale(lmat4$residuals), pch = 20, main = "lmat4")
abline(0, 1, col = "red")
lmat5 <- lm(atdiff ~ trtgroup + attachbase + sites + race + sex + smoker, data = dat)
AIC(lmat5)
lmat6 <- lm(atdiff ~ trtgroup + attachbase + sites + age + sex + smoker, data = dat)
AIC(lmat6)
lmat7 <- lm(atdiff ~ trtgroup + attachbase + sites + age + race + smoker, data = dat)
AIC(lmat7)
lmpd1 <- lm(pddiff ~ trtgroup, data = dat)
lmat8 <- lm(atdiff ~ trtgroup + attachbase + sites + age + race + sex, data = dat)
AIC(lmat8)
lmat9 <- lm(atdiff ~ trtgroup + attachbase, data = dat)
AIC(lmat9)
plot(lmat9$residuals ~ lmat9$fitted.values, pch = 20, main = "lmat9")
qqnorm(scale(lmat9$residuals), pch = 20, main = "lmat9")
abline(0, 1, col = "red")
lmat10 <- lm(atdiff ~ trtgroup + sites, data = dat)
AIC(lmat10)
lmat11 <- lm(atdiff ~ trtgroup + age, data = dat)
AIC(lmat11)
lmat12 <- lm(atdiff ~ trtgroup + race, data = dat)
AIC(lmat12)
lmat13 <- lm(atdiff ~ trtgroup + sex, data = dat)
AIC(lmat13)
lmat14 <- lm(atdiff ~ trtgroup + smoker, data = dat)
AIC(lmat14)
rm(lmat1, lmat2, lmat3, lmat4, lmat5, lmat6, lmat7, lmat8, lmat10, lmat11, lmat12, lmat13, lmat14)
rm(lmpd1, lmpd13, lmpd15)
pdfinal <- lm(pddiff ~ trtgroup + pdbase, data = dat)
atfinal <- lm(atdiff ~ trtgroup + attachbase, data = dat)
rm(lmpd9, lmat9)
rm(dropout.rows, dat.dropout)
plot(pdfinal$residuals ~ pdfinal$fitted.values, pch = 20, main = "PD: Residuals vs Fitted Values")
qqnorm(scale(pdfinal$residuals), pch = 20, main = "Normal Q-Q Plot PD Residuals")
abline(0, 1, col = "red")
qqnorm(scale(pdfinal$residuals), pch = 20, main = "PD: Normal Q-Q Plot of Residuals")
abline(0, 1, col = "red")
atfinal <- lm(atdiff ~ trtgroup + attachbase, data = dat)
plot(atfinal$residuals ~ atfinal$fitted.values, pch = 20, main = "Attachment: Residuals vs Fitted Values")
qqnorm(scale(atfinal$residuals), pch = 20, main = "Attachment: Normal Q-Q Plot of Residuals")
abline(0, 1, col = "red")
summary(pdfinal)
summary(atfinal)
summary(pdfinal, catvar = 2)
table(dat$trtgroup)
aggregate(pddiff ~ trtgroup, dat, mean)
dat$trtgroup <- relevel(dat$trtgroup, ref = 2)
table(dat$trtgroup)
aggregate(pddiff ~ trtgroup, dat, mean)
pdfinal <- lm(pddiff ~ trtgroup + pdbase, data = dat)
summary(pdfinal)
atfinal <- lm(atdiff ~ trtgroup + attachbase, data = dat)
summary(atfinal)
install.packages(gmodels)
install.packages('gmodels')
library(gmodels)
CrossTable(dat$trtgroup, dat$race)
CrossTable(dat$trtgroup, dat$race, prop.chisq = FALSE, prop.t = FALSE)
table(dat$trtgroup, dat$race)
dropout.rows <- which(is.na(dat$pd1year)) # gives the row numbers for the people that dropped out at 1year
dat.nomissing <- subset(dat, drop = c(dropout.row))
dat.nomissing <- subset(dat, drop = c(dropout.rows))
dat.nomissing <- subset(dat, drop = dat[dropout.rows, ])
dat.nomissing <- dat[!dropout.rows, ]
dat.nomissing <- dat[!is.na(dat$pd1year), ]
table(dat.nomissing$trtgroup, dat.nomissing$race)
table(dat$trtgroup, dat$sex)
table(dat$sex)
table(dat.nomissing$trtgroup, dat.nomissing$sex)
table(dat$trtgroup, dat$smoker)
table(dat.nomissing$trtgroup, dat.nomissing$smoker)
table(dat$trtgroup, dat$race)
table(dat.nomissing$trtgroup, dat.nomissing$race)
